@model InvoicePreCheckModels;
<script src="~/js/invoicing.js"></script>
<script src="~/js/invoicingerrorhandling.js"></script>
<script src="~/js/emailinvoicing.js"></script>
<link href="~/css/invoicing.css" rel="stylesheet" />
<script src="//cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.css" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.17.0/dist/xlsx.full.min.js"></script>
<link rel="shortcut icon" href="https://cdn.icon-icons.com/icons2/574/PNG/96/Invoicing_icon-icons.com_54813.png" type="image/x-icon" />
<div class="TopRight">
    <div onclick="DevMode()" class="square"></div>
</div>
<div id="InitialPageLoad">
    <div class="container">
        <div class="loader">
            <div class="loader--dot"></div>
            <div class="loader--dot"></div>
            <div class="loader--dot"></div>
            <div class="loader--dot"></div>
            <div class="loader--dot"></div>
            <div class="loader--dot"></div>
            <button class="loader--control-button" onclick="toggleLoader()">Pause</button>
            <div class="loader--text1"></div>
            <div class="loader--text"></div>
        </div>
    </div>
</div>

<div id="ModelError" class="ModelLoadError" hidden>
    <div>
        <h1>There was an error loading the page data</h1>
        <label id="ModelErrorMessage">Error:</label>
    </div>
    <button class="ErrorOptions" onclick="history.back()">Home Page</button>
    <button class="ErrorOptions" onclick="RefreshPage()">Refresh Page</button>
    <button class="ErrorOptions" onclick="ConnectToXero()">Reload Xero</button>

    <button class="ErrorOptions ErrorOptions-Report" onclick="window.location.href = 'https://192.168.0.17:666/Home/ReportIssue'">Report It to IT</button>


</div>
<div hidden class="NetworkToInvoice" id="NetworkToInvoice">
    
    <button class="ErrorOptions" onclick="RefreshPage()">Refresh Page</button>
    <button hidden class="DevMode" onclick="GoTOEmail()">Go to email</button>
    <button hidden class="DevMode" onclick="GoToInvoiceReport()">Go to Invoice Report</button>

    <button hidden class="DevMode" onclick="GoToInvoice()">Go to Invoice</button>

    <h1>Please Select a network to check</h1>
    <select id="NetworkSelect" onchange="showSelectedNetworkCheckList(this)">
        <option disabled selected value="">Please Select an option to start</option>
        <option  value="Keyfuels">Keyfuels</option>
        <option  value="Texaco">Texaco</option>
        <option value="UkFuels">UkFuels</option>
        <option  value="FuelGenie">FuelGenie</option>
    </select>

    <div class="NavOptions">
        <button class="button" onclick="location.href='@Url.Action("InvoiceReport", "Home")'">Go to invoice report</button>

    </div>
</div>

<div id="CheckListContainer" class="CheckListContainer" hidden>

    <button class="button" onclick="goBackFromNetworkCheck(this)">Back</button>
    <button class="button" onclick="selectAllCheckBoxes(this)">Select All</button>
   

    <table id="CheckListTable" class="CheckListTable">
        <thead>
        </thead>
        <tbody>
        </tbody>
    </table>
    <div class="ButtonContainer">
        <button onclick="ApproveButtonClick()" id="ApproveButton" hidden>Approve</button>
    </div>
</div>

<div hidden id="InvoiceSection" class="InvoiceSection">
    <div id="ButtonGroupInvoicing" class="ChoiceButtonGrouping">
        <button class="Invoicingbtn" onclick="StartInvoicing(this)" id="StartInvoicingBTN">Start Invoicing</button>
        <button class="Invoicingbtn" onclick="ResumeInvoicing(this)" id="ResumeInvoicingBTN" hidden>Resume Invoicing</button>
    </div>
    <div id="CustomerDetails" class="CustomerDetails">
        <div class="CustomerDetails-item">
            <label id="CustNameInvoicing">Customer Name:</label>
        </div>
        <div class="CustomerDetails-item">
            <label id="CountOfCustomersToBeInvoiced">Number of Customers to be Invoiced: 0</label>
        </div>
    </div>
    <div id="TransactionsTableContainer">
        <table class="InvoicingTable" id="InvoiceSectionTransactionTable">
            <thead>
                <tr>
                    <th>TransactionNumber</th>
                    <th>TransactionDate</th>
                    <th>TransactionTime</th>
                    <th>SiteCode</th>
                    <th>CardNumber</th>
                    <th>ProductCode</th>
                    <th>Quantity</th>
                    <th>Cost</th>
                    <th>Site Name</th>
                    <th>Invoice Price</th>
                    <th>Unit Price</th>
                    <th>Product</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div hidden class="InvoicingLoaderContainer" id="InvoiceingLoader">
    <div class="s1">
        <div class="s b sb1"></div>
        <div class="s b sb2"></div>
        <div class="s b sb3"></div>
        <div class="s b sb4"></div>
    </div>

    <div class="s2">
        <div class="s b sb5"></div>
        <div class="s b sb6"></div>
        <div class="s b sb7"></div>
        <div class="s b sb8"></div>
    </div>

    <div class="bigcon">
        <div class="big b"></div>
    </div>
    <div class="CreateThisClass">
        <button hidden id="PauseBTN" class="loader--control-button" onclick="PauseCurrentProcess(this)">Pause</button>
        <div hidden class="pausing-indicator ">
            <div class="pause-circle"></div>
            <div class="pausing-text">Pausing<span class="dots"></span></div>
        </div>
    </div>
</div>


<div hidden class="LargeTableDiv" id="InvoiceReportSection">
    <div class="Grouping">
        <button class="button" onclick="LoadInvoiceReport()">Load Invoice Report</button>
        <button id="exportTableButton" onclick="exportTableToExcel('InvoiceReportTable')">Export to Excel</button>
        <button class="button" onclick="ContinueAfterInvoiceReport()">Continue</button>
    </div>
    <div class="table-container">
        <table id="InvoiceReportTable">

            <thead>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>

<script>
   

    // Attach this function to the button click event
    document.getElementById("exportTableButton").addEventListener("click", function () {
        exportTableToCSV('invoice_report.csv');
    });
</script>

<div hidden id="EmailOutSection" class="EmailOutSection">
    <div hidden id="ResumeEmailing" class="Topleft">
        <button name="ResumeEmails" class="button" onclick="ResumeEmails(this)">Resume Emailing</button>
    </div>

    <button onclick="StartEmailing(this)" id="StartEmail">Start emailing</button>

    <div class="section">
    </div>
    <div class="DisplayItemsContainer" hidden id="DisplayEmailItemsContainer">
        <div>
            <div class="CustDetailsContainer">
                <div class="CustomerDetails-item">
                    <label>Customer Name:</label>
                    <label id="EmailCustomerName"></label>
                </div>
                <div class="CustomerDetails-item">
                    <label>Number of Customers to be emailed:</label>
                    <label id="CountOfCustomersToBeEmailed"></label>

                </div>
                <div class="CustomerDetails-item">
                    <label>Account Number:</label>
                    <label id="EmailAccountNumber"></label>
                </div>
            </div>
            <div class="HtmlAndPDfSeperator">
                <div id="HtmlCon" class="HtmlOrPdf">
                    <div class="EmailContainer">
                        <div id="EmailHtml" class="EmailHtml">
                        </div>
                    </div>
                </div>

                <div id="PFfCon" class="HtmlOrPdf">
                    <div id="PDFImgContainer" class="PDFImageContainer">
                    </div>
                </div>
            </div>
        </div>
        <div class="EmailButtons">
            <button onclick="SendAllEmails(this)" id="SendEmails">Send all emails</button>
        </div>
    </div>
</div>
